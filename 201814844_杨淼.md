## å®žéªŒæŠ¥å‘Š1ï¼šVSMå’ŒKNN

#### å®žéªŒå†…å®¹

1. é¢„å¤„ç†æ–‡æœ¬æ•°æ®é›†ï¼Œå¹¶ä¸”å¾—åˆ°æ¯ä¸ªæ–‡æœ¬çš„VSMè¡¨ç¤ºã€‚
2. å®žçŽ°KNNåˆ†ç±»å™¨ï¼Œæµ‹è¯•å…¶åœ¨20Newsgroupsä¸Šçš„æ•ˆæžœã€‚

#### å®žéªŒçŽ¯å¢ƒ

- Windows 8.1
- Python 3.6(Anaconda)
- CPU-only

#### å®žéªŒæ­¥éª¤

##### VSMæ¨¡åž‹

1. é‡‡ç”¨textblob packageè¿›è¡Œæ•°æ®é¢„å¤„ç†ï¼Œåˆ†åˆ«å»ºç«‹æ¯ä¸ªæ–‡ä»¶çš„å­—å…¸ï¼Œè®¡ç®—Term Frequency(TF)ï¼Œå¹¶ä»¥å­—å…¸çš„æ–¹å¼å­˜å‚¨åˆ°æœ¬åœ°ã€‚

   - Normalization

   ```python
   s = f.read().lower() # All in lower cases
   s = s.replace('/', ' ')
   s = s.replace('-', ' ') # Delete '/' and '-'
   ```

   - Tokenization

   ```python
   w = TextBlob(s).words
   ```

   - Stemming

   ```python
   word = Word(word)
   word = word.lemmatize() # deal with noun words
   word = Word(word)
   word = word.lemmatize("v") # deal with verb words
   ```

   - Stopwords

   ```python
   ntlk.download("stopwords") # download the stopwords dataset
   stop_words = stopwords.words('english')
   clean_w_list = []
   
   if(word not in stop_words and (word not in ['\'s', '\'ll', '\'t'])):
       clean_w_list.append(word)	# delete the words in stopwords
   ```

   - ç”Ÿæˆå­—å…¸ï¼Œè®¡ç®—TF

   ```python
   clean_w_dict = dict(collections.Counter(clean_w_list))
   ```

2. ç”Ÿæˆè®­ç»ƒé›†å’Œæµ‹è¯•é›†ã€‚

   - 80% è®­ç»ƒé›†
   - 20% æµ‹è¯•é›†

   æµ‹è¯•é›†å’Œè®­ç»ƒé›†å‡åŒ€çš„ä»Žæ¯ä¸ªç±»ä¸­éšæœºæŠ½å–ã€‚

3. éåŽ†æ‰€æœ‰è®­ç»ƒé›†æ–‡ä»¶çš„å­—å…¸ï¼Œå»ºç«‹Global Dictionaryï¼Œè®¡ç®—Document Frequency(DF)ã€‚è¿‡æ»¤æŽ‰DFå°äºŽ15çš„å•è¯åŽç”Ÿæˆæ–°çš„å­—å…¸ã€‚

   ```python
   global_dict={}
   for key in tmp_file_dict:
       if(key in global_dict.keys()):
           global_dict[key] += 1
       else:
           global_dict[key] = 1
   ```

4. æ ¹æ®æ­¥éª¤1ä¸­è®¡ç®—çš„TFå’Œæ­¥éª¤3ä¸­è®¡ç®—çš„DFï¼Œè®¡ç®—TF-IDF Weightï¼Œå»ºç«‹Vectorã€‚
   $$
   Weight=TF*IDF
   $$


- Term Frequency(TF) with sub-linear scaling:
  $$
  TF(t,d)=1+log(c(t,d))\\c(t,d)\;be\;the\;frequency\;count\;of\;term\;t\;in\;doc\;d
  $$

- Inverse Document Frequency(IDF) with non-linear scaling:
  $$
  IDF(t)=log(\frac{N}{df(t)})\\df(t)\;Number\;of\;docs\;containing\;term\;ð‘¡\\N\;Total\;number\;of\;docs\;in\;collection
  $$


é¦–å…ˆå°†å­—å…¸ä¸­çš„æ¯ä¸€ä¸ªtermæ˜ å°„åˆ°indexä¸Šï¼Œç„¶åŽéåŽ†æ¯ä¸ªæ–‡ä»¶çš„æ¯ä¸ªtermï¼Œå¹¶è®¡ç®—æ¯ä¸ªtermçš„weightæ”¾åˆ°å¯¹åº”çš„indexä¸‹æ¥æž„é€ vectorã€‚ï¼ˆè€ƒè™‘åˆ°å­—å…¸çš„é•¿åº¦ä»¥åŠæ–‡ä»¶çš„ä¸ªæ•°è¿‡å¤§ï¼Œä¸ºæå‡æ•ˆçŽ‡ï¼Œé‡‡ç”¨scipy.sparseåŒ…ä¸­çš„csr_matrixç¨€ç–çŸ©é˜µæ¥å­˜å‚¨ã€‚ï¼‰

##### KNNæ¨¡åž‹

###### KNNåŽŸç†ï¼š

è®­ç»ƒé›†æ˜¯mä¸ªn-dimensionçš„vectorï¼Œå¹¶ä¸”å·²çŸ¥ç›¸åº”çš„labelã€‚å¯¹æµ‹è¯•é›†ä¸­çš„æ¯ä¸ªæ•°æ®ï¼Œè®¡ç®—è®­ç»ƒé›†ä¸­è·ç¦»å…¶æœ€è¿‘çš„kä¸ªneighborsï¼ˆæœ¬å®žéªŒä¸­é€‰å–çš„æ•°å€¼æ˜¯5ï¼‰ï¼Œå…¶ä¸­æŠ•ç¥¨æœ€å¤šlabelå³ä¸ºæµ‹è¯•é›†ä¸­è¯¥æ•°æ®çš„labelã€‚

###### è·ç¦»çš„å®šä¹‰ï¼š

- Euclidean distance
  $$
  d(p,q)=\sqrt{\sum_{i=1}(p_i-q_i)^2}
  $$

- Cosine Similarity
  $$
  d(p,q)=-cosine(p,q)=-\frac{{V_p}^TV_q}{|V_P|_2|V_q|_2}
  $$


åœ¨æœ¬æ¬¡å®žéªŒä¸­ï¼Œé€‰æ‹©çš„æ˜¯Cosine Similarityä½œä¸ºè¡¡é‡è·ç¦»çš„å•ä½ã€‚

###### Voteçš„æƒé‡ï¼š

æ ¹æ®è·ç¦»ç»™kä¸ªneighborsçš„voteèµ‹äºˆä¸åŒçš„æƒé‡ã€‚
$$
weight\;factor=\frac{1}{d^2}
$$
èµ‹äºˆæƒé‡çš„æ„ä¹‰ï¼š

- å¯ä»¥ä½¿å¾—æŠ•ç¥¨ç»“æžœä¸ä»…å–å†³äºŽç¥¨æ•°ï¼Œä¸”åŒæ—¶æ›´è¶‹å‘äºŽè·ç¦»æ›´è¿‘çš„ç‚¹ã€‚
- å½“å­˜åœ¨ä¸¤ä¸ªç¥¨æ•°ç›¸åŒçš„labelçš„æ—¶å€™ï¼Œä¼šé€‰æ‹©è·ç¦»æ•´ä½“è·ç¦»æ›´è¿‘çš„labelï¼Œå¢žåŠ å‡†ç¡®çŽ‡ã€‚

###### æé«˜ç®—æ³•çš„æ•ˆçŽ‡ï¼š

åœ¨è®¡ç®—KNNæ—¶ï¼Œéœ€è¦è®¡ç®—æµ‹è¯•é›†ä¸­æ¯ä¸ªvectorå’Œè®­ç»ƒé›†ä¸­æ¯ä¸ªvectorçš„è·ç¦»ï¼Œæ—¶é—´å¤æ‚åº¦è‡³å°‘ä¸ºo(10^7)

å‚è€ƒYangLinçš„æ€è·¯ï¼Œé€‰æ‹©äº†sklearn.neighborsçš„BallTreeæ¥æé«˜ç®—æ³•æ•ˆçŽ‡ã€‚ç”±äºŽBallTreeçš„å†…ç½®è·ç¦»ä¸åŒ…å«Cosineè·ç¦»ï¼Œå¯ç”¨å‘é‡å½’ä¸€åŒ–åŽçš„æ¬§æ°è·ç¦»ä»£æ›¿Cosineè·ç¦»ã€‚æŽ¨å¯¼å¦‚ä¸‹ï¼š
$$
Euclidean\;Distance=\frac{(X-Y)(X-Y)^T}{|X|_2|Y|_2}
$$
å°†ä¸Šå¼å±•å¼€å¯å¾—ï¼š
$$
ED=XX^T+YY^T-XY^T-YX^T
$$


æŠŠXã€Yå‘é‡å½’ä¸€åŒ–åŽï¼Œä¸Šå¼å¯ç®€åŒ–ä¸ºï¼š
$$
ED=\frac{2-2XY^T}{|X|_2|Y|_2}
$$
ç”±ä¸Šå¼å¯çŸ¥ï¼Œå‘é‡å½’ä¸€åŒ–åŽçš„æ¬§æ°è·ç¦»å’ŒCosineè·ç¦»æ˜¯æˆåæ¯”çš„ã€‚ä¸”å‘é‡å½’ä¸€åŒ–åŽï¼Œå‘é‡ä¹‹é—´çš„å¤¹è§’æ˜¯ä¸å˜çš„ã€‚

#### æ–‡ä»¶ç»“æž„

- ä¸»ç›®å½•

| 20news-18828   å­˜æ”¾æ–‡ä»¶æ•°æ®

| file_dict_folder   å­˜æ”¾æ¯ä¸ªæ–‡ä»¶çš„å­—å…¸

| result_balltree   å­˜æ”¾BallTreeçš„è¿è¡Œç»“æžœ

| result_original   å­˜æ”¾åŽŸå§‹æ–¹æ³•çš„è¿è¡Œç»“æžœ

**| VSM_KNN.py è¿è¡Œä»£ç **

- ç»“æžœç›®å½•ï¼ˆresult_balltree/result_originalï¼‰

|| global_dict_filtered.txt   è®­ç»ƒé›†å­—å…¸

|| output.txt   è¾“å‡ºçš„logæ–‡ä»¶ï¼ˆæœªçŸ¥åŽŸå› logåŽç¼€ä¸èƒ½ä¸ŽgithubåŒæ­¥ï¼Œå› æ­¤ä¿®æ”¹ä¸ºtxtæ–‡ä»¶ï¼‰

|| testing_path.txt   ä¿å­˜æµ‹è¯•é›†è·¯å¾„

|| training_path.txt   ä¿å­˜è®­ç»ƒé›†è·¯å¾„

#### å®žéªŒç»“æžœ

BallTree Result:(with vote weight)

> true_num:3318 total_num:3759 accuracy:0.882682
> The Ball Tree Query has finished: it takes 962.904263s

Original Result:(without vote weight)

> true_num:3265 total_num:3759 accuracy:0.868582
> The KNN has finished: it takes 19946.281052s

ç”±äºŽCosine Similarityè¶Šå¤§è¶Šå¥½ï¼Œå³då€¼è¶Šå¤§ä¸¤ä¸ªvectorè¶ŠæŽ¥è¿‘ã€‚è€Œvoteçš„weightä¸Ždæˆåæ¯”ï¼Œdè¶Šå¤§weightåè€Œè¶Šå°ï¼Œä¸Žäº‹å®žå†²çªã€‚åº”è¯¥æ˜¯då€¼è¶Šå¤§weightè¶Šå¤§æ‰å¯¹ã€‚å› è€Œè€ƒè™‘åœ¨åŽŸå§‹æ–¹æ³•ä¸­ä¸ä½¿ç”¨Vote Weightã€‚

åœ¨BallTreeæ–¹æ³•ä¸­ï¼Œç”±äºŽæœ€åŽè®¡ç®—çš„æ˜¯æ¬§å¼è·ç¦»ï¼Œæ‰€ä»¥æ»¡è¶³Vote Weightçš„å®šä¹‰ï¼Œå¯ä»¥ä½¿ç”¨ã€‚ç”±ç»“æžœå¯çŸ¥ï¼Œå…¶å¯ä»¥åœ¨ä¸€å®šç¨‹åº¦ä¸Šæå‡é¢„æµ‹çš„å‡†ç¡®çŽ‡ã€‚





## å®žéªŒæŠ¥å‘Š2ï¼šæœ´ç´ è´å¶æ–¯åˆ†ç±»å™¨

#### å®žéªŒå†…å®¹

å®žçŽ°æœ´ç´ è´å¶æ–¯åˆ†ç±»å™¨ï¼Œæµ‹è¯•å…¶åœ¨20 Newsgroupsæ•°æ®é›†ä¸Šçš„æ•ˆæžœã€‚

#### å®žéªŒçŽ¯å¢ƒ

- Windows 8.1
- Python 3.6(Anaconda)
- CPU-only

#### å®žéªŒåŽŸç†

Xæ˜¯ä¸€ä¸ªå…·æœ‰nä¸ªåˆ†é‡çš„ç‰¹å¾å‘é‡ï¼Œæ¯ä¸ªåˆ†é‡çš„å–å€¼ä¸º{0,1}

Yæ˜¯åˆ†ç±»ç»“æžœï¼Œå…±æœ‰kä¸ªåˆ†ç±»ï¼Œå–å€¼èŒƒå›´ä¸º{1,2,...,k}

å‡è®¾å…±mä¸ªæ ·æœ¬
$$
X\in{(x_1,x_2,...,x_n)}x_j\in\lbrace0,1\rbrace
$$

$$
Y\in{\lbrace1,2,...,k\rbrace}
$$

$$
\mathop{argmax}\limits_{y \in Y}P(Y=y^{(i)}|X=x^{(i)})
$$

ç”±è´å¶æ–¯å®šç†å¯å¾—
$$
=>\mathop{argmax}\limits_{y\in Y}\frac{P(x|y)P(y)}{P(x)}=>\mathop{argmax}\limits_{y\in Y}P(x|y)P(y)
$$

$$
=>\mathop{argmax}\limits_{y\in Y}P(x_1,x_2,...,x_k|y)P(y)
$$

å‡è®¾Xçš„å„ä¸ªåˆ†é‡ä¹‹é—´æ˜¯ç›¸äº’ç‹¬ç«‹çš„
$$
=> \mathop{argmax}\limits_{y\in Y}\prod_{j=1}^{k}P(x_j|y)P(y)
$$
è€ƒè™‘åˆ°P(x_j|y)å¯èƒ½ä¸º0ï¼Œå¯¹å…¶é‡‡ç”¨Laplaceå¹³æ»‘ã€‚

- ##### åœ¨æœ¬å®žéªŒä¸­

P(y)=ç±»åˆ«ä¸ºyçš„æ–‡ä»¶ä¸ªæ•° / æ‰€æœ‰æ–‡ä»¶çš„ä¸ªæ•°

P(x_j|y)=(ç±»åˆ«ä¸ºyçš„æ–‡ä»¶ä¸­è¯è¯­x_jå‡ºçŽ°çš„æ¬¡æ•°+1) / (ç±»åˆ«ä¸ºyçš„æ–‡ä»¶ä¸­æ‰€æœ‰è¯è¯­çš„æ¬¡æ•°+è¢«ç»Ÿè®¡çš„è¯è¡¨ä¸­è¯è¯­ä¸ªæ•°)

ä¸ºæ–¹ä¾¿è®¡ç®—ï¼Œå¯¹ä¸Šè¿°ç›®æ ‡å‡½æ•°å–logï¼Œå¹¶é‡‡ç”¨å¤šé¡¹å¼æ¨¡åž‹ï¼ˆç»Ÿè®¡å’Œåˆ¤æ–­æ—¶éƒ½å…³æ³¨é‡å¤æ¬¡æ•°ï¼‰åŠLaplaceå¹³æ»‘ï¼ˆé¿å…P(x_j|y) ä¸º0ï¼‰ã€‚

#### å®žéªŒæ­¥éª¤

##### å®žéªŒæ•°æ®

åˆ©ç”¨Homework1ä¸­å¾—åˆ°çš„ 

- __testing_path.txt__  æµ‹è¯•é›†è·¯å¾„
- __training_path.txt__  è®­ç»ƒé›†è·¯å¾„
- __global_dict_filtered.txt__ è®­ç»ƒé›†å…¨å±€å­—å…¸
- æ–‡ä»¶å¤¹__file_dict_folder__ æ¯ä¸ªæ–‡ä»¶çš„è¯é¢‘

ä»¥åŠ æ–‡ä»¶å¤¹__20news-18828__ åŽŸå§‹æ•°æ®

##### å®žéªŒæ­¥éª¤

__æ­¥éª¤1:__éåŽ†training_pathï¼Œè®¡ç®—æ‰€æœ‰æ–‡ä»¶çš„ä¸ªæ•°total_countï¼Œå­—å…¸ class_file_countä¿å­˜æ¯ä¸€ç±»æ–‡ä»¶çš„ä¸ªæ•°ï¼Œä»¥åŠå­—ç¬¦ä¸²åˆ—è¡¨ä¿å­˜æ‰€æœ‰ç±»çš„åå­—class_nameã€‚

__æ­¥éª¤2:__å°†global dictä¸­çš„æ¯ä¸ªå•è¯æ˜ å°„åˆ°ä¸‹æ ‡ï¼›å°†class nameä¸­çš„æ¯ä¸€ä¸ªç±»åæ˜ å°„åˆ°ä¸‹æ ‡ã€‚

__æ­¥éª¤3:__éåŽ†training_pathå¯¹åº”æ–‡ä»¶çš„å­—å…¸ï¼Œæ ¹æ®æ­¥éª¤2ç”Ÿæˆçš„æ˜ å°„å…³ç³»ï¼Œå»ºç«‹ä¸€ä¸ªå¤§å°ä¸º(class_num, term_num)çš„ref_matrixä¿å­˜æ¯ä¸€ç±»ä¸­æ¯ä¸ªå•è¯å‡ºçŽ°çš„é¢‘æ•°

__æ­¥éª¤4:__éåŽ†testing_pathï¼Œå¯¹testing_pathçš„æ¯ä¸€ä¸ªæ•°æ®ï¼Œåˆ†åˆ«è®¡ç®—è¯¥æ•°æ®å±žäºŽæ¯ä¸ªç±»åˆ«çš„æ¦‚çŽ‡ã€‚

å¯¹äºŽæ¯ä¸ªç±»åˆ«ï¼Œè®¡ç®—P(y):

```python
p_c = class_file_count[class_name]/total_count
```

å¯¹testing_pathå¯¹åº”æ–‡ä»¶çš„å­—å…¸ï¼ŒéåŽ†å…¶æ‰€æœ‰åŒ…å«çš„å•è¯è®¡ç®—P(x|y):

```
p_t_c += tmp_file_dict[key] * np.log(float(tmp_term + 1) / (total_term + term_count))
```

(å…¶ä¸­tmp_file_dict[key]æ˜¯å½“å‰å•è¯åœ¨è¯¥æ–‡ä»¶ä¸­å‡ºçŽ°çš„é¢‘æ•°ï¼Œtmp_termæ˜¯å½“å‰å•è¯åœ¨è¯¥ç±»åˆ«ä¸­çš„é¢‘æ•°ï¼Œtotal_termæ˜¯è¯¥ç±»åˆ«æ‰€æœ‰å•è¯çš„ä¸ªæ•°ï¼Œterm_countæ˜¯è¯è¡¨ä¸­æ‰€æœ‰å•è¯çš„ä¸ªæ•°)

æœ€åŽå¾—åˆ°è¯¥ç±»åˆ«çš„æ¦‚çŽ‡ï¼š

```
p[class_idx]=p_t_c + np.log(p_c)
```

å¾—åˆ°æ¯ä¸ªç±»çš„æ¦‚çŽ‡åŽï¼Œæ±‚æœ€å¤§å€¼ã€‚å¾—åˆ°çš„å³ä¸ºå½“å‰testæ•°æ®å¯¹åº”çš„ç±»åˆ«ã€‚

#### ç›®å½•ç»“æž„

| 20news-18828   å­˜æ”¾æ–‡ä»¶æ•°æ®

| file_dict_folder   å­˜æ”¾æ¯ä¸ªæ–‡ä»¶çš„å­—å…¸

global_dict_filtered.txt   è®­ç»ƒé›†å­—å…¸

testing_path.txt   ä¿å­˜æµ‹è¯•é›†è·¯å¾„

training_path.txt   ä¿å­˜è®­ç»ƒé›†è·¯å¾„

result.log è¾“å‡ºçš„logæ–‡ä»¶ï¼Œä¿å­˜å¯¹äºŽæ¯ä¸ªç±»åˆ«çš„é¢„æµ‹ç»“æžœåŠç²¾ç¡®åº¦

NBC.py æœ´ç´ è´å¶æ–¯åˆ†ç±»å™¨å®žçŽ°ä»£ç 

#### å®žéªŒç»“æžœ

é¢„æµ‹çš„å‡†ç¡®çŽ‡ä¸º

> 0.8606012237297154





## å®žéªŒæŠ¥å‘Š3ï¼šæµ‹è¯•sklearnçš„èšç±»ç®—æ³•

#### å®žéªŒå†…å®¹

æµ‹è¯•sklearnä¸­ä»¥ä¸‹èšç±»ç®—æ³•åœ¨tweetsæ•°æ®é›†ä¸Šçš„èšç±»æ•ˆæžœã€‚k-means, AffinityPropagation, mean-shift, SpectralClustering, AgglomerativeClustering, DBSCAN, GaussianMixturesã€‚

#### å®žéªŒçŽ¯å¢ƒ

- ubuntu16.04
- python3.7
- sklearn 0.19.2

#### å®žéªŒåŽŸç†

- __K-Means__

  é¦–å…ˆéšæœºé€‰æ‹©kä¸ªèšç±»è´¨å¿ƒç‚¹ï¼Œé‡å¤ä»¥ä¸‹è¿‡ç¨‹ç›´åˆ°æ”¶æ•›ï¼š1ã€å¯¹äºŽæ¯ä¸ªæ ·ä¾‹ï¼Œé€‰æ‹©è·ç¦»å…¶æœ€è¿‘çš„èšç±»è´¨å¿ƒç‚¹ä½œä¸ºå…¶ç±»åˆ«cã€‚ 2ã€å¯¹äºŽæ¯ä¸ªç±»åˆ«cï¼Œè®¡ç®—æ‰€æœ‰åŒ…å«æ ·ä¾‹çš„å¹³å‡å€¼ä½œä¸ºæ–°çš„è´¨å¿ƒã€‚

- __Affinity Propagation__

  s(i,k):æ ·æœ¬iå’Œæ ·æœ¬kä¹‹é—´çš„ç›¸ä¼¼åº¦ã€‚

  r(i,k):å¸å¼•åº¦ã€‚æ ·æœ¬ké€‚åˆä½œä¸ºæ ·æœ¬içš„èšç±»ä¸­å¿ƒçš„ç´¯ç§¯ä¿¡ä»»åº¦ã€‚

  a(i,k):å½’å±žåº¦ã€‚æ ·æœ¬ i åº”è¯¥é€‰æ‹©æ ·æœ¬ k ä½œä¸ºå…¶èšç±»ä¸­å¿ƒçš„ç´¯ç§¯ä¿¡ä»»åº¦ã€‚

  damping factor:é˜»å°¼ç³»æ•°ï¼Œä¸ºäº†é¿å… r(i,k) å’Œ a(i,k) åœ¨æ›´æ–°æ—¶å‘ç”Ÿæ•°å€¼éœ‡è¡ï¼›

  preference:åå¥½å‚æ•°ï¼Œç›¸ä¼¼åº¦çŸ©é˜µä¸­æ¨ªè½´çºµè½´ç´¢å¼•ç›¸åŒçš„ç‚¹ã€‚

  ç®—æ³•æµç¨‹ï¼šï¼ˆ1ï¼‰è®¡ç®—åˆå§‹çš„ç›¸ä¼¼åº¦çŸ©é˜µï¼Œå°†å„ç‚¹ä¹‹é—´çš„å¸å¼•åº¦ r(i,k) å’Œå½’å±žåº¦ a(i,k) åˆå§‹åŒ–ä¸º 0ï¼› 

  ï¼ˆ2ï¼‰æ›´æ–°å„ç‚¹ä¹‹é—´çš„å¸å¼•åº¦ï¼Œéšä¹‹æ›´æ–°å„ç‚¹ä¹‹é—´çš„å½’å±žåº¦ï¼Œå…¬å¼å¦‚ä¸‹ï¼š![1](http://kylen314.com/wp-content/uploads/2013/11/APgengxingongshi.jpg)æŒ‰ç…§lamda(é˜»å°¼ç³»æ•°)çš„æ¯”ä¾‹è¿›è¡Œæ›´æ–°ã€‚

  ï¼ˆ3ï¼‰ç¡®å®šå½“å‰æ ·æœ¬ i çš„ä»£è¡¨æ ·æœ¬(exemplar)ç‚¹ kï¼Œkå°±æ˜¯ä½¿{a(i,k)+r(i,k)}å–å¾—æœ€å¤§å€¼çš„é‚£ä¸ª kï¼› 
  é‡å¤æ­¥éª¤ 2 å’Œæ­¥éª¤ 3ï¼Œç›´åˆ°æ‰€æœ‰çš„æ ·æœ¬çš„æ‰€å±žéƒ½ä¸å†å˜åŒ–ä¸ºæ­¢ï¼›

- __Mean-Shift__

  å¯¹äºŽé›†åˆä¸­çš„æ¯ä¸€ä¸ªå…ƒç´ xï¼ŒæŠŠè¯¥å…ƒç´ ç§»åŠ¨åˆ°å®ƒé‚»åŸŸä¸­æ‰€æœ‰å…ƒç´ ç‰¹å¾å€¼çš„å‡å€¼çš„ä½ç½®ï¼Œä¸æ–­é‡å¤ç›´åˆ°æ”¶æ•›ï¼ŒæŠŠè¯¥å…ƒç´ ä¸Žå®ƒçš„æ”¶æ•›ä½ç½®çš„å…ƒç´ æ ‡è®°ä¸ºåŒä¸€ç±»ã€‚è€ƒè™‘åˆ°é‚»åŸŸä¸­æ¯ä¸ªå…ƒç´ å¯¹xçš„é‡è¦ç¨‹åº¦ä¸ä¸€æ ·ï¼Œè·ç¦»è¿‘çš„å…ƒç´ å¯¹å…¶çš„å½±å“è¾ƒå¤§ï¼Œé‡‡ç”¨é«˜æ–¯æ ¸å‡½æ•°ï¼Œå¯¹å„ä¸ªå…ƒç´ è¿›è¡ŒåŠ æƒå¹¶å–å¹³å‡å€¼ï¼Œæ±‚å¾—åç§»å€¼ã€‚

- __Spectral Clustering__

  è°±èšç±»å°±æ˜¯å…ˆç”¨Laplacian eigenmapså¯¹æ•°æ®è¿›è¡Œé™ç»´ï¼ˆç®€å•æ¥è¯´å°±æ˜¯å…ˆå°†æ•°æ®è½¬æ¢æˆé‚»æŽ¥çŸ©é˜µæˆ–ç›¸ä¼¼æ€§çŸ©é˜µï¼Œå†è½¬æ¢æˆLaplaciançŸ©é˜µï¼Œå†å¯¹LaplaciançŸ©é˜µè¿›è¡Œç‰¹å¾åˆ†è§£ï¼ŒæŠŠæœ€å°çš„Kä¸ªç‰¹å¾å‘é‡æŽ’åˆ—åœ¨ä¸€èµ·ï¼‰ï¼Œç„¶åŽå†ç”¨k-meansèšç±»ã€‚ç”±äºŽé™çº¬çš„ä½œç”¨ï¼Œå®ƒçš„æ•ˆæžœé€šå¸¸æ¯”k-meanså¥½ï¼Œè®¡ç®—å¤æ‚åº¦ä½Žã€‚

- __Agglomerative Clustering__

  å±‚æ¬¡èšç±»çš„æ–¹æ³•ã€‚é€’å½’çš„åˆå¹¶èƒ½æœ€å°ç¨‹åº¦å¢žåŠ ç»™å®šé“¾æŽ¥è·ç¦»çš„ä¸€å¯¹ç°‡ã€‚

  __ä¸¤ä¸ªç°‡çš„é‚»è¿‘åº¦__ï¼š

  - wardï¼šå®šä¹‰ä¸ºä¸¤ä¸ªç°‡åˆå¹¶æ—¶å¯¼è‡´çš„å¹³æ–¹è¯¯å·®çš„å¢žé‡ã€‚
  - averageï¼šå®šä¹‰ä¸ºä¸¤ä¸ªç°‡é‡Œæ‰€æœ‰å…ƒç´ çš„å¹³å‡å€¼ä¹‹é—´çš„è·ç¦»ã€‚
  - complete or maximumï¼šå°†ä¸¤ä¸ªç°‡é‡Œè·ç¦»æœ€è¿œçš„è·ç¦»å®šä¹‰ä¸ºä¸¤ä¸ªç°‡çš„è·ç¦»ã€‚

- __DBSCAN__

  é¦–å…ˆè®¡ç®—æ¯ä¸ªç‚¹é‚»åŸŸä¸­çš„ç‚¹çš„ä¸ªæ•°ï¼Œè‹¥è¯¥ç‚¹é‚»åŸŸç‚¹çš„ä¸ªæ•°å¤§äºŽå½¢æˆé«˜å¯†åº¦åŒºåŸŸæ‰€éœ€çš„æœ€å°ç‚¹æ•°ï¼Œåˆ™è®²è¯¥ç‚¹å®šä¹‰ä¸ºæ ¸å¿ƒç‚¹ã€‚å¦‚æžœpæ˜¯æ ¸å¿ƒç‚¹ï¼Œåˆ™å®ƒä¸Žæ‰€æœ‰ç”±å®ƒå¯è¾¾çš„ç‚¹ï¼ˆåŒ…æ‹¬æ ¸å¿ƒç‚¹å’Œéžæ ¸å¿ƒç‚¹ï¼‰å½¢æˆä¸€ä¸ªèšç±»ï¼Œæ¯ä¸ªèšç±»æœ‰æœ€å°‘ä¸€ä¸ªæ ¸å¿ƒç‚¹ï¼Œéžæ ¸å¿ƒç‚¹ä¹Ÿå¯ä»¥æ˜¯èšç±»çš„ä¸€éƒ¨åˆ†ï¼Œä½†å®ƒåœ¨èšç±»çš„[è¾¹ç¼˜]ä½ç½®ï¼Œå› ä¸ºå®ƒä¸èƒ½è¾¾è‡³æ›´å¤šçš„ç‚¹ã€‚![img](https://upload.wikimedia.org/wikipedia/commons/thumb/a/af/DBSCAN-Illustration.svg/1024px-DBSCAN-Illustration.svg.png)

- __Gaussian Mixtures__

  EMç®—æ³•ã€‚è§‚å¯Ÿæ•°æ®x=(x_1, x_2, ... , x_m)  éšå˜é‡zã€‚

  é¦–å…ˆåˆå§‹åŒ–æ¨¡åž‹å‚æ•°thetaçš„åˆå€¼theta_0ã€‚

  E-stepï¼š![Q_i(z^{(i)}) := P( z^{(i)}|x^{(i)}Ã¯Â¼ÂŒ\theta)) \\](http://www.zhihu.com/equation?tex=Q_i%28z%5E%7B%28i%29%7D%29+%3A%3D+P%28+z%5E%7B%28i%29%7D%7Cx%5E%7B%28i%29%7D%EF%BC%8C%5Ctheta%29%29+%5C%5C)

  M-stepï¼š![\theta : = arg \max \limits_{\theta}\sum\limits_{i=1}^m\sum\limits_{z^{(i)}}Q_i(z^{(i)})log{P(x^{(i)}Ã¯Â¼ÂŒ z^{(i)}|\theta)} \\](http://www.zhihu.com/equation?tex=%5Ctheta+%3A+%3D+arg+%5Cmax+%5Climits_%7B%5Ctheta%7D%5Csum%5Climits_%7Bi%3D1%7D%5Em%5Csum%5Climits_%7Bz%5E%7B%28i%29%7D%7DQ_i%28z%5E%7B%28i%29%7D%29log%7BP%28x%5E%7B%28i%29%7D%EF%BC%8C+z%5E%7B%28i%29%7D%7C%5Ctheta%29%7D+%5C%5C)

  é‡å¤EMæ­¥éª¤ç›´åˆ°thetaæ”¶æ•›ã€‚

- __Birch__

  é¦–å…ˆéœ€è¦å»ºç«‹CFæ ‘ã€‚æœ‰ä¸¤ä¸ªé‡è¦çš„å‚æ•°ï¼šé˜ˆå€¼T(åˆ¤æ–­æ˜¯å¦å¸æ”¶è¯¥èŠ‚ç‚¹å…¥ç°‡) åˆ†æ”¯é˜ˆå€¼L(æœ€å¤§åˆ†æ”¯ä¸ªæ•°)

  1ã€ä»Žæ ¹èŠ‚ç‚¹å‘ä¸‹å¯»æ‰¾å’Œæ–°æ ·æœ¬è·ç¦»æœ€è¿‘çš„å¶å­èŠ‚ç‚¹å’Œå¶å­èŠ‚ç‚¹é‡Œæœ€è¿‘çš„CFèŠ‚ç‚¹

  2ã€å¦‚æžœæ–°æ ·æœ¬åŠ å…¥åŽï¼Œè¿™ä¸ªCFèŠ‚ç‚¹å¯¹åº”çš„è¶…çƒä½“åŠå¾„ä»ç„¶æ»¡è¶³å°äºŽé˜ˆå€¼Tï¼Œåˆ™æ›´æ–°è·¯å¾„ä¸Šæ‰€æœ‰çš„CFä¸‰å…ƒç»„ï¼Œæ’å…¥ç»“æŸã€‚å¦åˆ™è½¬å…¥3.

  3ã€å¦‚æžœå½“å‰å¶å­èŠ‚ç‚¹çš„CFèŠ‚ç‚¹ä¸ªæ•°å°äºŽé˜ˆå€¼Lï¼Œåˆ™åˆ›å»ºä¸€ä¸ªæ–°çš„CFèŠ‚ç‚¹ï¼Œæ”¾å…¥æ–°æ ·æœ¬ï¼Œå°†æ–°çš„CFèŠ‚ç‚¹æ”¾å…¥è¿™ä¸ªå¶å­èŠ‚ç‚¹ï¼Œæ›´æ–°è·¯å¾„ä¸Šæ‰€æœ‰çš„CFä¸‰å…ƒç»„ï¼Œæ’å…¥ç»“æŸã€‚å¦åˆ™è½¬å…¥4ã€‚

  4ã€å°†å½“å‰å¶å­èŠ‚ç‚¹åˆ’åˆ†ä¸ºä¸¤ä¸ªæ–°å¶å­èŠ‚ç‚¹ï¼Œé€‰æ‹©æ—§å¶å­èŠ‚ç‚¹ä¸­æ‰€æœ‰CFå…ƒç»„é‡Œè¶…çƒä½“è·ç¦»æœ€è¿œçš„ä¸¤ä¸ªCFå…ƒç»„ï¼Œåˆ†å¸ƒä½œä¸ºä¸¤ä¸ªæ–°å¶å­èŠ‚ç‚¹çš„ç¬¬ä¸€ä¸ªCFèŠ‚ç‚¹ã€‚å°†å…¶ä»–å…ƒç»„å’Œæ–°æ ·æœ¬å…ƒç»„æŒ‰ç…§è·ç¦»è¿œè¿‘åŽŸåˆ™æ”¾å…¥å¯¹åº”çš„å¶å­èŠ‚ç‚¹ã€‚ä¾æ¬¡å‘ä¸Šæ£€æŸ¥çˆ¶èŠ‚ç‚¹æ˜¯å¦ä¹Ÿè¦åˆ†è£‚ï¼Œå¦‚æžœéœ€è¦æŒ‰å’Œå¶å­èŠ‚ç‚¹åˆ†è£‚æ–¹å¼ç›¸åŒã€‚

  æ‰€æœ‰çš„å¶å­èŠ‚ç‚¹é‡Œçš„æ ·æœ¬ç‚¹å°±æ˜¯ä¸€ä¸ªèšç±»çš„ç°‡ã€‚

#### å®žéªŒæ­¥éª¤

- sklearn.cluster.KMeans  => n_clusters èšç±»ä¸ªæ•°  random_state éšæœºåˆå§‹åŒ–
- sklearn.cluster.AffinityPropagation ==> damping é˜»å°¼ç³»æ•°ï¼Œé˜²æ­¢æŠ–åŠ¨
- sklearn.cluster.MeanShift ==> bandwidth é«˜æ–¯æ ¸çš„å‚æ•°(ç±»ä¼¼äºŽå†³å®šé«˜çº¬çƒçš„åŠå¾„) bin_seeding ä¼˜åŒ–åŠ é€Ÿ
- sklearn.cluster.SpectralClustering ==> n_clusters èšç±»ä¸ªæ•° random_state éšæœºåˆå§‹åŒ–
- sklearn.cluster.AgglomerativeClustering ==> n_clusters èšç±»ä¸ªæ•° linkage ç¡®å®šè®¡ç®—è·ç¦»çš„æ–¹æ³•(ward, average, complete)
- sklearn.cluster.DBSCAN ==> eps ç¡®å®šé‚»åŸŸçš„å¤§å° min_samples å¯†é›†åŒºåŸŸæ‰€éœ€æœ€å°æ ·æœ¬ç‚¹
- sklearn.mixture.GaussianMixture ==> n_components èšç±»ä¸ªæ•°
- sklearn.cluster.Birch ==> n_clusters èšç±»ä¸ªæ•° threshold é«˜ç»´çƒåŠå¾„ branching_factor åˆ†æ”¯ä¸ªæ•°

é€šè¿‡sklearn.metrics.clusterçš„normalized_mutual_info_scoreæ–¹æ³•ï¼Œè®¡ç®—å¾—åˆ†ï¼Œåˆ¤æ–­èšç±»å¥½åã€‚

#### å®žéªŒç»“æžœ

> K-Means score:0.779488
>
> Affinity Propogation score:0.794534
>
> Mean-Shift score:0.727855
>
> Spectral Clustering score:0.780187
>
> Agglomerative Clustering-ward score:0.783041
>
> Agglomerative Clustering-complete score:0.755440
>
> Agglomerative Clustering-average score:0.896244
>
> DBSCAN score:0.656964
>
> Gaussian Mixtures score:0.790252
>
> Birch score:0.800036

